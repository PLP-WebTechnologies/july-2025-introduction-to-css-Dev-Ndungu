"""
DATA ANALYSIS & VISUALIZATION ASSIGNMENT
Dataset: Iris (from sklearn)
"""

# =========================
# Import Libraries
# =========================
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.datasets import load_iris

# =========================
# Task 1: Load and Explore the Dataset
# =========================
try:
    iris_data = load_iris(as_frame=True)  # Load Iris dataset
    df = iris_data.frame  # Convert to pandas DataFrame
    print("✅ Dataset loaded successfully!\n")
except FileNotFoundError:
    print("❌ Error: Dataset file not found.")
    exit()
except Exception as e:
    print(f"❌ Error while loading dataset: {e}")
    exit()

# Display first rows
print("📌 First 5 rows of dataset:")
print(df.head())

# Dataset structure
print("\n📌 Dataset Info:")
print(df.info())

# Missing values
print("\n📌 Missing Values:")
print(df.isnull().sum())

# Clean dataset (drop missing if any)
df = df.dropna()

# =========================
# Task 2: Basic Data Analysis
# =========================

# Descriptive statistics
print("\n📌 Summary Statistics:")
print(df.describe())

# Grouping: Mean values per species
grouped = df.groupby("target").mean()
print("\n📌 Mean values grouped by Target (species code):")
print(grouped)

# Add species names for clarity
df["species"] = df["target"].map({i: name for i, name in enumerate(iris_data.target_names)})

# Interesting finding: Petal length difference
print("\n📌 Average Petal Length by Species:")
print(df.groupby("species")["petal length (cm)"].mean())

# =========================
# Task 3: Data Visualization
# =========================
sns.set(style="whitegrid")

# 1. Line chart: Petal length trend
plt.figure(figsize=(8,5))
plt.plot(df.index, df["petal length (cm)"], label="Petal Length")
plt.title("Line Chart: Petal Length Trend")
plt.xlabel("Index")
plt.ylabel("Petal Length (cm)")
plt.legend()
plt.show()

# 2. Bar chart: Avg petal length per species
plt.figure(figsize=(8,5))
sns.barplot(x="species", y="petal length (cm)", data=df, estimator="mean")
plt.title("Bar Chart: Avg Petal Length by Species")
plt.xlabel("Species")
plt.ylabel("Average Petal Length (cm)")
plt.show()

# 3. Histogram: Sepal length distribution
plt.figure(figsize=(8,5))
plt.hist(df["sepal length (cm)"], bins=20, color="skyblue", edgecolor="black")
plt.title("Histogram: Sepal Length Distribution")
plt.xlabel("Sepal Length (cm)")
plt.ylabel("Frequency")
plt.show()

# 4. Scatter plot: Sepal length vs Petal length
plt.figure(figsize=(8,5))
sns.scatterplot(x="sepal length (cm)", y="petal length (cm)", hue="species", data=df, s=80)
plt.title("Scatter Plot: Sepal Length vs Petal Length")
plt.xlabel("Sepal Length (cm)")
plt.ylabel("Petal Length (cm)")
plt.legend(title="Species")
plt.show()
